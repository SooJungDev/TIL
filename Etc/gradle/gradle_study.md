## 그레이들이란?
빌드 도구
그레이들 스크립트 기반
그루비 기반이기 때문에 문법 구조가 자바와 비슷
그루비 JVM 기반언어이기 때문에 그레이들은 그루비가 가진 장점을 가지고 있다.
이와 함께 자바에 없는 클로저와 같은 기능은 그레이들을 더욱 유연한 빌드도구로 사용 할 수 있도록 도와준다.

그레이들은 빌드 순서를 태스크에 의한 의존관계로 정하기 때문에 빌드 스크립트에서 빌드 순서 제어하기 쉬움
이식성도 좋음
그레이들은 빌드 스크립트를 활용하여 다양한 기능을 손쉽게 참고하고 사용하도록 DSL(Domain Specific Language)문법도 제공하고 있다.

DSL 역시 그루비 기반으로 간단하게 빌드스크립트에서 사용할수 있도록 해주는것으로
그루비의 동적 타이핑 기능을 활용하여 구현된 부분

## 그레이들 VS 메이븐
메이븐 특징 XML 기반 프로젝트 규모가 커지고 복잡해질수록 메이븐의 빌드환경 구성인 build.xml 파일도 복잡해지고 점점 코드의 양도 많아져 관리의 어려움

이러한 어려움과 함께 DSL(Domain Specific Language) 에 대한 관심이 증가하고 이를 이용하여 빌드의 환경을 구성하고자 하면서 그레이들이 탄생하게 되었습니다.

빌드 수행 그레이들 > 메이븐

빠른 속도 이유 3가지
1. 빌드를 수행할대 작업의 입출력을 추적하여 필요한 작업에 대하여 실행하고 가능하다면 변경된 부분만을 처리하여 중복작업을 수행하지 않도록 하는 증분적인방법으로 빌드를 수행
2. 빌드캐시를 사용하여 빌드 출력에 이용
3. Gradle demon 을 사용하여 빌드 관련 정보가 메모리에서 최신상태를 유지하도록 프로세스를 사용

## 빌드란?
프로그래밍한 소스코드를 complie, test, deploy, 문서화 등을 수행하는 일련의 작업

## 그레이들의 빌드
빌들르 수행하기 위해 스크립트 파일, 속성파일, 환경 변수나 명령어의 옵션 속성, buildSrc 프로젝트 디렉터리등의 정보를 참조하게 됩니다.

그레이들 스크립트 3가지 종류
- 초기화 스크립트 (init script) Gradle 객체
- 설정 스크립트(setting script)  Settings 객체
- 빌드 스크립트(build script) Project 객체


초기화 스크립트는 init.gradle 로 파일이름이 명명
사용자 정보, 실행환경, 초기 선언 값 설정등 초기 설정정보 기술하고 정의하여 설정

설정 스크립트(settings script)
- 빌드의 대상이 되는 프로젝트를 정의하고 해당 프로젝트가 싱글프로젝트인지 멀티프로젝트인지 결정하게되고 프로젝트 인스턴스를 생성 할 수 있습니다.

build script 는 그레이들의 핵심 스크립트라고 할 수 있습니다.
빌드 수행과 관련된 의존 관계 정의, 태스크 정의등의 내용이 기술되고 기본 파일 이름은 build.gradle로 이파일만 있어도 빌드를 수행하기에 필요 충분하 ㄴ요소

그레이들 속성파일
gradle.properties 명명
해당 프로젝트에 gradle.properties 파일이 있다면 빌드 수행시 자동으로 참조하여 내용을 확인하게됨


명령어 해석/수행 -> 그레이들 실행 -> 스크립트 초기화 -> 프로젝트 설정 -> 태스크 실행 -> 결과 출력


script 파일 확인 및 읽기
멀티 or 싱글프로젝트 판단
Project 객체 생성
명령어 옵션 및 인수설정

프로젝스 설정 단계
이단계에서 태스크 그래프라는것이 작성됨
태스크 그래프는 프로젝트에서 빌드를 수행하기 위해 정의되어 있는 태스크들을 확인하여 태스크들 사이의 의존관계를 확인하게 되고 확인된 의존관례를 바탕으로 태스크 그래프를 생성하게 됩니다

다음으로 태스크를 실행하게 됩니다.
태스크 실행은 프로젝트 설정단계에서 작성된 태스크 그래프에서 대상이되는 태스크를 확인하여 빌드를 실행하게 됩니다. 그리고 실행이 마무리되면 결과를 출력하여 빌드를 마무리하게 됩니다.

끝으로 빌드 수행이 마무리되면 빌드 수행과 관련된 결과 및 결과와 관련된 정보를 출력하게 되며, 출력은 조금전 실습한 것 처럼 명령 프롬프트 상에서와 같이 나타날 수 도 있으며,
HTML 과 XML 과 같은 형태로 결과물을 얻을 수도 있습니다.

## groovy 문법
def 형 사용
- 자바와 같은 형을 지정해서 사용 할 수도 있지만 그루비에서 형 지정을 하지 않을때에는 def 를 사용합니다.
- def 는 메서드의 매개변수나 반환값을 받을 때에도 적용할 수있으며 메서드에서 매개 변수의 형을 생략하면 def 로 인식하게됩니다.
- 또한 def 형도 객체의 메서드나 속성등 명시적인 형 지정때와같이 참조 할 수 있습니다.
~~~groovy
// 자바와 같이 형 지정
String id = 'gradle'
// 형 지정 생략(Groovy의 형 지정특징)
def id = 'gradle'
println id.toUpperCase() // 속성 참조 가능
~~~

문자열 사용
- 작은따옴표 : 자바에서 사용할때와 유사하게 문자열을 지정할때 사용
- 큰따옴표: 문자열에 $기호를 사용하여 동적으로 내용을 지정할때 사용합니다
~~~groovy
def id = "ID : ${project.id}"
String id = "ID : $id" // {} 생략 가능
~~~

- 또한 작음따옴표와 큰따옴표는 중첩되게 3개를 이용하여 여러개의 문자열을 사용할 수도 있습니다
~~~groovy
def id = '''gradle
Groovy
script '''

def id = """gradle
Groovy
script """
~~~

괄호의 생략
- 그루비는 메서드를 호출 할 때 괄호 ()를 생략할 수 있습니다.
- 단 모든 경우에 생략 할 수 있는것은 아닙니다.
~~~groovy
// 생략 가능한 경우
println('hello')
println 'hello'
~~~

클로저의 사용
- 그레이들 스크립트 파일에서 클로저는 많이 사용되는 구조
- 클로저는 중괄호를 이용하여 정의하고 해당 클로저를 call() 속성이나 일반 메서드처럼 호출하여 실행 할 수 있습니다.
~~~groovy
// task 정의시 클로저
task hello <<{
  println "Hello Gradle!"
}

// 클로저 사용
def id = { closer -> println "id, $closer"}

// call() 이용한 사용
id.call('gradle')

// 일반 메서드 호출 방식 사용
id('gradle')

// 괄호를 생략하고 사용
id 'gradle'
~~~

명령문
- 명령문 뒤에 세미콜론 생략가능

리스트와 맵
- 리스트는 배열처럼 사용하고 배열처럼 접근 할 수 있습니다.
~~~groovy
def id = ['grade', 'Groovy']
id[1] = 'script'
assert id[1] == 'script'
~~~

- Map 도 리스트처럼  대괄호[]를 이용하여 정의하고 접근 할 수 있습니다.
~~~groovy
def id = ['a': 'grade', 'b': 'Groovy']
assert id['a'] == 'gradle'
~~~

비교
자바의 equals()와 동일하게 그루비는 == 를 이용하여 문자열 등을 비교하게 됩니다. 그러나 객체가 같은지 비교하려면 is()를 사용하여 비교해야합니다.

## 그레이들의 스크립트 파일 구조
- 그레이들의 스크립트는 그루비 스크립트라고 할 수 있습니다.
- 그레이들 스크립트 파일은 두가지 요소로 구성되어 있는데 처리문 영역과 스크립트 블록 영역

- 처리문은 일반적인 프로그래밍에서 지역변수, 속성 정의및 설정, 메서드등
- 스크립트 블록은 특정한 그레이들 프로젝트를 빌드하기 위한 부분으로 그레이들에서 사용되는 개념으로 앞에서 살펴본 task 선언시 정의한 클로저와같은 부분
~~~groovy
// 처리문
def id = 'gradle'

// 스크립트 블록
repositories{
  mavenCentral()
}

task idCheck << {
  def id = 'check'
  println 'id : '+id
}
~~~
- 스크립트 블록은 클로저를 인수로 하는 메서드로 그레이들의 주로 스크립트 블록으로는 buildscript, subproject, repositories, dependencies 등이 있습니다.

스크립트 블록
- repositories : 저장소 설정
- dependencies : 의존 관계 설정
- buildscript : 빌드 스크립트 클래스 패스 설정
- initscript : 초기화 스크립트 설정
- configurations: 환경 구성 설정
- allprojects : 서브 프로젝트 포함 전체 프로젝트 설정
- subprojects: 서브 프로젝트 설정
- artifacts : 빌드 결과에 대한 설정

확장 속성
- ext 라는 예약어를 사용하여 스크립트 파일에서 도메인 객체의 속성을 추가할때 사용하게 됩니다.
~~~
ext {
  extPro1 = 'pro1'
  extPro2 = 'pro2'
}

// 사용방법
println '속성값 1: '+ext.extPro1
println '속성값 2: '+ext.extPro2
~~~

## 속성 파일에서 속성 추가 방법
- 속성 파일인 gradle.properties '속성명=속성값'
~~~
//gradle.properties
msg=Hi, Gradle!
~~~

## 그레이들 기본
~~~
task hello << {
    println "Hello Gradle!"
}

// 출력할 문자열을 def 형으로 선언 및 클로저 정의
def strMsg = { println 'Hello Gradle!' }
// hello 태스크
task hello {}
// leftShift() 를 사용한 문자열 출력

~~~
<< 
- 연산자는 작업이 실행 될 때 실행될 작업 동작 또는 일련의 작업을 정의하는데 사용된다.
- 일반적으로 태스크 정의 블록에서 태스크의 동작을 지정하는데 사용됩니다.
- 그레이들에서 태스크를 지정하기 위해서는 << 연산자를 사용해야하는데 이 연산자는 leftShift() 생략형으로 위와같이 할수 있음

~~~
task gradleTask1<<{
   println 'This is Gradle Task One' //내부에서 태스크로 인식했는지 여부에 따른 차이
}

task gradleTask2 {
  println 'This is Gradle Task Two'
}
~~~



참고
- 열혈강의 gradle 책



