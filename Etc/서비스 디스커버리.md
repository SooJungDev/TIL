## 서비스 디스커버리
- 클라우드에서 인스턴스는 동적으로 할당되기 때문에 ip주소나 포트 정보가 정해지지 않음
- 오토스케일링도 일어나고 중지되고 복구되면서 네트워크 위치가 계속해서 바뀌게됨
- 따라서 **클라이언트나 API 게이트웨이가 호출할 서비스를 찾는 메커니즘이 필요하고 이를 서비스 디스커버리라고함**

두가지 방식으로 나눔
- 클라이언트 사이드 디스커버리 패턴
- 서버 사이드 디스커버리 패턴

## 클라이언트 사이드 디스커버리
- 서비스 인스턴스의 네트워크 위치를 찾고 로드밸런싱하는 역할을 클라이언트가 담당하는 방식
- 서비스 인스턴스는 시작될때 자신의 네트워크 주소를 서비스 레지스트리에 등록하고, 서비스 레지스트리는 각 서비스 인스턴스 상태를 계속해서 체크함
- 클라이언트는 서비스 레지스트리에 등록된 인스턴스 중 하나를 골라서 요청을 보내는 방식으로 로드밸런싱이 이루어짐
- 인스턴스가 종료되면 서비스 레지스트리에 등록된 정보는 삭제됨

- Netflix OSS 가 클라이언트 사이드 디스커버리 패턴의 좋은예
- Netflix Eureka 는 서비스 레즈스트리로 서비스 인스턴스 등록과 가용한 인스턴스를 찾는 REST API 를 제공
- Netflix Ribbon 은 유레카같 동작하는 IPC 클라이언트로 가능한 서비스 인스턴스 간 로드밸런싱을 해줌

잠점
- 디스커러비 로직을 클라이언트가 가지고 잇기 때문에 서비스에 맞는 로드밸런싱 방식을 각자 구현할 수있 다는 점
단점
- 각 서비스 마다 서비스 레즈스트리를 구현해야 하는 종속성이 생김
- 만약 서비스마다 다른 언어를 사용 하고있다면 언어별 또는 프레임워크별로 구별

## 서버 사이드 디스커버리
- 서버쪽에서 디스커버리 로직을 구현한 방식입니다.
- 클라이언트는 로드밸런서로 요청을 보냄
- 로드밸런서는 서비스 레지스트리를 조회해서 가용한 인스턴스를 찾고 그중 선택해서 요청을 라우팅 하는 방식
- 서비스 레지스트리에 등록되는 방식은 클라이언트에 있을때와 같음



## 참고사이트
- [마이크로서비스 Microservices (4) 서비스 디스커버리](https://futurecreator.github.io/2018/10/18/service-discovery-in-microservices/)
