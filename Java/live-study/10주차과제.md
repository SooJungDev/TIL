# 10주차 과제
목표
- 자바의 멀티쓰레드 프로그래밍에 대해 학습하세요.

학습할것 (필수)
- Thread 클래스와 Runnable 인터페이스
- 쓰레드의 상태
- 쓰레드의 우선순위
- Main 쓰레드
- 동기화
- 데드락

## Thread 클래스와 Runnable 인터페이스
자바에서 쓰레드를 구현하는 방법은 Thread 클래스를 상속받는법, Runnable 인터페이스를 구현하는 방법 2가지가 있음

1. Thread 클래스를 상속
~~~java
class ThreadEx1 {
    public static void main(String[] args) {
        final ThreadEx1_1 thread1 = new ThreadEx1_1();
        thread1.start();

    }
}

class ThreadEx1_1 extends Thread{
    @Override
    public void run() {
        for(int i=0; i<5; i++){
            System.out.println(getName()); // 조상인 Thread 의 getName() 을 호출
        }
    }
}
~~~
2. Runnable 인터페이스 구현
- Runnable 인터페이스를 구현한 경우 Runnable 인터페이스를 구현한 클래스의 인터페이스를 생성한 다음, 이 인스턴스를 가지고 Thread 클래스의 인스턴스를 생성할때 생성자의 매개변수로 제공해줘야한다.
~~~java
 class ThreadEx2 {
     public static void main(String[] args) {
         Runnable runnable= new ThreadEx2_1();
         final Thread thread = new Thread(runnable);
         thread.start();

     }
}

class ThreadEx2_1 implements Runnable{

    @Override
    public void run() {
        for(int i=0; i<5; i++){
            // Thread.currentThread() 현재 실행중인 Thread 를 반환한다.
            System.out.println(Thread.currentThread().getName());
        }
    }
}
~~~

- Thread 클래스의 소스를 살펴보면 Thread 클래스의 생성자는 Thread(Runnable target) 로 호출시에 Runnable 인터페이스를 구현한 클래스의 인스턴스를 넘겨줘야한다
<img width="700" alt="스크린샷 2021-01-21 오전 12 05 36" src="https://user-images.githubusercontent.com/38197944/105194013-8297f080-5b7c-11eb-97e9-c3fae59521a6.png">

- Run 을 호출하면 참조변수 target 을 통해서 Runnable 인터페이스를 구현한 인스턴스의 run() 이 호출된다. 이렇게 함으로써 상속을 통해 run()을 오버라이딩하지 않고도 외부로부터 제공받을 수 있게 된다.
<img width="748" alt="스크린샷 2021-01-21 오전 12 10 37" src="https://user-images.githubusercontent.com/38197944/105194610-1d90ca80-5b7d-11eb-82fd-ec120e0c6dcd.png">


## 쓰레드의 상태
| 상태 | 설명 |
|-|-|
| NEW | 쓰레드가 생성되고 아직 start()가 호출되지 않은 상태 |
| RUNNABLE | 실행 중 또는 실행 가능한 상태 |
| BLOCKED | 동기화블럭에 의해서 일시정지된 상태(lock이 풀릴때까지 기다리는 상태) |
| WAITING, TIMED_WAITING | 쓰레드의 작업이 종료되지는 않았지만 실행가능하지 않은(unrunnable) 일시정지상태, TIMED_WAITING 은 일시정지시간이 지정된 경우를 의미한다. |
| TERMINATED | 쓰레드의 작업이 종료된 상태 |

## 쓰레드의 우선순위
Thread.java 클래스 일부
~~~java
public
class Thread implements Runnable {
    /* Make sure registerNatives is the first thing <clinit> does. */
    private static native void registerNatives();
    static {
        registerNatives();
    }

    private volatile String name;
    private int priority;
    .....

    /**
     * The minimum priority that a thread can have.
     */
    public static final int MIN_PRIORITY = 1;

   /**
     * The default priority that is assigned to a thread.
     */
    public static final int NORM_PRIORITY = 5;

    /**
     * The maximum priority that a thread can have.
     */
    public static final int MAX_PRIORITY = 10;
~~~
- 쓰레드는 우선순위(priority) 라는 속성(멤버변수)를 가지고 있는데, 이 우선순위의 값에 따라 쓰레드가 얻는 실행시간이 달라진다. 쓰레드가 수행하는 작업의 중요도에 따라 쓰레드의 우선순위를 서로 다르게 지정하여 특정 쓰레드가 더많은 작업시간을 갖도록 할 수 있다.
- 쓰레드가 가질 수 있는 우선순위의 범위는 1-10이며 숫자가 높을수록 우선순위가 높다
- 우선순위의 높고 낮음은 절대적이 아니라 상대적인 것임으로 주의
- 쓰레드의 우선순위는 쓰레드를 생성한 쓰레드로 부터 받는다는것
- main 메서드를 수행하는 쓰레드는 우선순위가 5이므로 main 메서드에서 생성하는 쓰레드의 우선순위는 자동적으로 5가된다.

~~~java
class ThreadPriorityEx {
    public static void main(String[] args) {
        final ThreadEx3 threadEx3 = new ThreadEx3();
        final ThreadEx4 threadEx4 = new ThreadEx4();

        threadEx3.setPriority(7);
        System.out.println("priority of threadEx3(-) :"+threadEx3.getPriority());
        System.out.println("priority of threadEx4(|) :"+threadEx4.getPriority());

        threadEx3.start();
        threadEx4.start();
    }
}

class ThreadEx3 extends Thread {
    @Override
    public void run() {
        for (int i = 0; i < 300; i++) {
            System.out.print("-");
        }
    }
}

class ThreadEx4 extends Thread {
    @Override
    public void run() {
        for (int i = 0; i < 300; i++) {
            System.out.print("|");
        }
    }
}

~~~

- 실행결과
~~~
priority of threadEx3(-) :7
priority of threadEx4(|) :5
---|||||||||------------------------------------------------------------------------------------|||||||||---------------||||--------------------------------------------------||||||||||||||||||||||||||||-------------------------------|||||||||||||||||||||||||||||||||||||||||---------------------------------------------------------------------------------------------------------------------|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
~~~


## Main 쓰레드

## 동기화

## 데드락

## 참고
- 자바의 정석
- [Thread API](https://download.java.net/java/early_access/loom/docs/api/java.base/java/lang/Thread.html)
- https://javagoal.com/main-thread-in-java/